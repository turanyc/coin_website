{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Turan/OneDrive/Masa%C3%BCst%C3%BC/my-crypto-tracker/my-crypto-tracker/src/pages/api/coins/%5BcoinId%5D.ts"],"sourcesContent":["// pages/api/coins/[coinId].ts\r\nimport { NextApiRequest, NextApiResponse } from 'next';\r\nimport { Pool } from 'pg';\r\n\r\nconst pool = new Pool({\r\n  user: process.env.POSTGRES_USER,\r\n  host: process.env.POSTGRES_HOST,\r\n  database: process.env.POSTGRES_DATABASE,\r\n  password: process.env.POSTGRES_PASSWORD,\r\n  port: parseInt(process.env.POSTGRES_PORT || '5432'),\r\n});\r\n\r\nexport default async function handler(req: NextApiRequest, res: NextApiResponse) {\r\n  const { coinId } = req.query;\r\n\r\n  if (!coinId || typeof coinId !== 'string') {\r\n    return res.status(400).json({ error: 'Coin ID gerekli' });\r\n  }\r\n\r\n  try {\r\n    // Veritabanından coin detaylarını çek\r\n    const result = await pool.query(\r\n      `SELECT \r\n        id, name, symbol, current_price, price_change_percentage_24h, \r\n        market_cap, total_volume, image, last_updated\r\n      FROM coins\r\n      WHERE LOWER(TRIM(id)) = LOWER(TRIM($1))\r\n      ORDER BY last_updated DESC NULLS LAST, market_cap DESC\r\n      LIMIT 1`,\r\n      [coinId]\r\n    );\r\n\r\n    if (result.rows.length === 0) {\r\n      return res.status(404).json({ error: 'Coin bulunamadı' });\r\n    }\r\n\r\n    const row = result.rows[0];\r\n    \r\n    // Veriyi parse et ve hazırla\r\n    const coinData = {\r\n      id: row.id,\r\n      name: row.name,\r\n      symbol: row.symbol,\r\n      current_price: parseFloat(row.current_price) || 0,\r\n      price_change_percentage_24h: parseFloat(row.price_change_percentage_24h) || 0,\r\n      market_cap: parseFloat(row.market_cap) || 0,\r\n      total_volume: parseFloat(row.total_volume) || 0,\r\n      image: row.image || null,\r\n      last_updated: row.last_updated,\r\n    };\r\n\r\n    res.status(200).json(coinData);\r\n  } catch (error) {\r\n    console.error('Coin Detail API Error:', error);\r\n    res.status(500).json({ error: 'Veritabanından veri çekilemedi.' });\r\n  }\r\n}\r\n\r\n"],"names":[],"mappings":"AAAA,8BAA8B;;;;;AAE9B;;;;;;AAEA,MAAM,OAAO,IAAI,4GAAI,CAAC;IACpB,MAAM,QAAQ,GAAG,CAAC,aAAa;IAC/B,MAAM,QAAQ,GAAG,CAAC,aAAa;IAC/B,UAAU,QAAQ,GAAG,CAAC,iBAAiB;IACvC,UAAU,QAAQ,GAAG,CAAC,iBAAiB;IACvC,MAAM,SAAS,QAAQ,GAAG,CAAC,aAAa,IAAI;AAC9C;AAEe,eAAe,QAAQ,GAAmB,EAAE,GAAoB;IAC7E,MAAM,EAAE,MAAM,EAAE,GAAG,IAAI,KAAK;IAE5B,IAAI,CAAC,UAAU,OAAO,WAAW,UAAU;QACzC,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAkB;IACzD;IAEA,IAAI;QACF,sCAAsC;QACtC,MAAM,SAAS,MAAM,KAAK,KAAK,CAC7B,CAAC;;;;;;aAMM,CAAC,EACR;YAAC;SAAO;QAGV,IAAI,OAAO,IAAI,CAAC,MAAM,KAAK,GAAG;YAC5B,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAAkB;QACzD;QAEA,MAAM,MAAM,OAAO,IAAI,CAAC,EAAE;QAE1B,6BAA6B;QAC7B,MAAM,WAAW;YACf,IAAI,IAAI,EAAE;YACV,MAAM,IAAI,IAAI;YACd,QAAQ,IAAI,MAAM;YAClB,eAAe,WAAW,IAAI,aAAa,KAAK;YAChD,6BAA6B,WAAW,IAAI,2BAA2B,KAAK;YAC5E,YAAY,WAAW,IAAI,UAAU,KAAK;YAC1C,cAAc,WAAW,IAAI,YAAY,KAAK;YAC9C,OAAO,IAAI,KAAK,IAAI;YACpB,cAAc,IAAI,YAAY;QAChC;QAEA,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;IACvB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAkC;IAClE;AACF"}}]
}